---
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Statistical Rethinking 2026
## A1 Solution (Mukto Akash)

From combinatorics, we know that there should be ${10 \choose 8} = {10 \choose 2} = 45$ ways to get $8$ "heads" from 10 coin flips (out of $2^{10}$ possibilities). Using the Garden of Forking Data approach: at each coin flip, there are two possible outcomes. We can use recursion to compute the number of ways to get $8$ "heads" from $10$ flips. This gives us the number of ways to get the sample if all participants are honest.

```{r}
possib <- c("H", "T")
count <- 0

x_heads_from_n_flips <- function(num_flips, num_heads){
  if (num_heads < 0 || num_heads > num_flips) {
    return(0)
  } else if (num_heads == num_flips){
    return(1)
  }
  
  for (flip in possib) {
    if (flip == "H"){
      count <- count + x_heads_from_n_flips(num_flips - 1, num_heads - 1)
    } else {
      count <- count + x_heads_from_n_flips(num_flips -1, num_heads)
    }
  }
  
  return(count)
}
```

Check that the function works in obvious cases:
```{r}
print(x_heads_from_n_flips(10, 0))
print(x_heads_from_n_flips(10, 10))
print(x_heads_from_n_flips(3, 2))
print(x_heads_from_n_flips(4, 2))
print(count)
```
Now compute the answer:
```{r}
print(x_heads_from_n_flips(10, 8))
```

Now if $5$ of the participants are honest, then we must have that the other $5$ are dishonest and hence will always claim "heads". Thus, we can treat this case as just $5$ coin flips with $3$ heads. Thus, there are ${5 \choose 3} = 10$ ways to get $3$ heads from $5$ flips. As the other $5$ flips don't matter, out of $10$ flips the number of ways to get the sample of $8$ out of $10$ heads will be $$2^5 \times {5 choose 3} = 320$.

To get the maximum, we can do a grid search.

```{r}
num_honest <- seq(0:10)-1
num_ways <- function(n_honest, n_flips = 10, n_heads = 8){
  return(2^(n_flips - n_honest) * x_heads_from_n_flips(n_honest, 
  n_heads - (n_flips - n_honest)))
}

max_honest <- which.max(sapply(num_honest, num_ways))
print(max_honest)
```

Thus, `r max_honest` honest people maximizes the number of ways to get this sample.